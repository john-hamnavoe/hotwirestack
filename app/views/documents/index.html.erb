<% content_for :title, "Documents" %>

<% frame = "documents_index" %>

<%= render Index::ContainerComponent.new do |c| %>
  <% c.with_header do %>
    <%= render Index::HeaderComponent.new(
      title: "Documents",
      action_text: "New document",
      action_path: new_document_path
    ) %>
  <% end %>

  <% c.with_search_form do %>
    <%= render Index::SearchFormComponent.new(
      query: @query,
      frame: frame,
      placeholder: "Search documents",
      search_session_token: @search_session[:token]
    ) %>
  <% end %>

  <% c.with_table do %>
  <%= render Index::TableComponent.new(
    frame: frame,
    items: @documents,
    columns: [
      { header: "Title", attribute: :title, primary: true },
      { header: "Active", attribute: :active, method: ->(doc) { doc.active ? "Yes" : "No" } },
      { header: "Edit", type: :action, action: ->(document) { link_to "Edit", edit_document_path(document, search_session: @search_session[:token]), class: "text-indigo-600 hover:text-indigo-900", data: { turbo_frame: :_top }  }, sr_only: true},
      { header: "Delete", type: :action, action: ->(document) { button_to "Delete", document_path(document, search_session: @search_session[:token]), method: :delete, class: "text-red-600 hover:text-red-900", form: { data: { turbo_confirm: 'Are you sure?' } } }, sr_only: true }
    ],
    pagy: @pagy,
    query: @query
    ) %>
  <% end %>
<% end %>
